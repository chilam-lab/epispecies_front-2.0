<body><br>
  <div class="container-fluid">
    <div class="row justify-content-center">
      <div class="col-2">
        <h4>Modo</h4>
      </div>
    </div>
  </div>
  <div class="container-fluid">
    <div class="row">
      <div class="row py-0">
        <div class="col-md-1 d-flex justify-content-left my-2">Modelo:</div>
        <div class="col-md-11">
          <div class="row">
            <div class="col-md-4 justify-content-center my-2">
              <mat-select [(ngModel)]="selectedFirstClassId" class="bootstrap-style-mat-select"
                (ngModelChange)="onFirstClassChange($event)">
                <mat-option [value]="env.placeholderFirstClass" disabled selected>{{env.placeholderFirstClass}}</mat-option>
                <ng-container *ngFor="let sickness of firstClassList">
                  <mat-option [value]="sickness[0]">{{sickness[1]}}</mat-option>
                </ng-container>
              </mat-select>
            </div>
            <div class="col-md-4 justify-content-center my-2">
              <mat-select [(ngModel)]="selectedSecondClassId" class="bootstrap-style-mat-select"
                [disabled]="secondClassSelectDisable" (ngModelChange)="onSecondClassChange($event)"
                title="Esta selección es opcional" data-bs-toggle="tooltip">
                <mat-option [value]="env.placeholderSecondClass" selected>{{env.placeholderSecondClass}}</mat-option>
                <ng-container *ngFor="let group of secondClassList">
                  <mat-option [value]="group[0]">{{group[1]}}</mat-option>
                </ng-container>
              </mat-select>
            </div>
            <div class="col-md-4 my-2">
              <mat-select [(ngModel)]="selectedThirdClassId" class="bootstrap-style-mat-select"
                [disabled]="thirdClassSelectDisable" title="Esta selección es opcional" data-bs-toggle="tooltip">
                <mat-option [value]="env.placeholderThirdClass" selected>{{env.placeholderThirdClass}}</mat-option>
                <ng-container *ngFor="let cause of thirdClassList">
                  <mat-option [value]="cause[0]">{{cause[1]}}</mat-option>
                </ng-container>
              </mat-select>
            </div>
          </div>
        </div>
      </div>
      <div class="row py-0 h-25 ">
        <div class="col-md-1 d-flex justify-content-left my-2">Filtrar por:</div>
        <div class="col-md-2 d-flex justify-content-center my-2">
          <mat-select [(ngModel)]="selectedAge" class="bootstrap-style-mat-select">
            <mat-option [value]="env.placeholderAge" selected>{{env.placeholderAge}}</mat-option>
            <ng-container *ngFor="let age of agesList">
              <mat-option [value]="age[0]">{{age}}</mat-option>
            </ng-container>
          </mat-select>
        </div>
        <div class="col-md-2 d-flex justify-content-center my-2">
          <mat-select [(ngModel)]="selectedGender" class="bootstrap-style-mat-select">
            <mat-option [value]="env.placeholderGender" selected>{{env.placeholderGender}}</mat-option>
            <ng-container *ngFor="let genderId of gendersList">
              <mat-option [value]="genderId">{{gendersDict[genderId]}}</mat-option>
            </ng-container>
          </mat-select>
        </div>
        <div class="col-md-2 d-flex justify-content-center my-2">
          <mat-select [(ngModel)]="selectedRegion" (ngModelChange)="showingModalsFromSelect()" class="bootstrap-style-mat-select">
            <mat-option value={{env.placeholderCountry}}  (click)="showingModalsFromSelect()" selected>Todo el país </mat-option>
            <mat-option value={{env.placeholderState}}  (click)="showingModalsFromSelect()" selected>{{env.placeholderState}}</mat-option>
            <mat-option value={{env.placeholderMunicipal}}  (click)="showingModalsFromSelect()">{{env.placeholderMunicipal}} </mat-option>
            <mat-option value={{env.placeholderMetropoli}} (click)="showingMetropoliModal()">{{env.placeholderMetropoli}}</mat-option>
          </mat-select>
        </div>
        <div class="col-md-2 d-flex justify-content-center my-2">
          <mat-select [(ngModel)]="selectedResolution" class="bootstrap-style-mat-select">
            <mat-option *ngIf="selectedRegion!=env.placeholderMunicipal" value={{env.placeholderStateResolution}}>{{env.placeholderStateResolution}}</mat-option>
            <mat-option value={{env.placeholderMunResolution}} selected>{{env.placeholderMunResolution}}</mat-option>
          </mat-select>
        </div>
        <div class="col-md-2 d-flex justify-content-center my-2">
          <div class="select-with-button-container">
            <mat-select [(ngModel)]="selectedYear" class="bootstrap-style-mat-select">
              <mat-option [value]="selectedYear" selected>{{selectedYear}}</mat-option>
              <ng-container *ngFor="let year of yearsList">
                <mat-option [value]="year">{{year}}</mat-option>
              </ng-container>
            </mat-select>
            <button mat-icon-button type="button" data-bs-toggle="modal" data-bs-target="#periodModal">
              <mat-icon>date_range</mat-icon>
            </button>
          </div>
        </div>
        <!-- <div class="col-1 d-flex justify-content-center my-2"> -->
        <div class="col-lg-1 d-flex justify-content-center  my-2">
          <button class="updateButton" (click)="updateTheDataForTheMap()">Actualizar</button>
        </div>
      </div>
    </div>
  </div>

  <div class="container-fluid map-container">
    <div class="row">
      <div class="col-lg-12 map-section">
        <div class="row row-map">
          <app-map [updatedResolution]="updatedResolution" [dataByMunToDisplayInMap]="dataByMunToDisplayInMap" [selectedCVEState]="selectedCVEState" [selectedCVEMun]="selectedCVEMun" [statesAndMunList]="statesAndMunList" [selectedYear]="selectedYear" [selectedMetropoly]="selectedMetropoly">
          </app-map>
        </div>
      </div>
    </div>
  </div>
  <br>
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-3 justify-content-center">
        <h2>Información detallada</h2>
      </div>
    </div><br>
    <div class="row">
      <div class="col-md-3 justify-content-center">
         <h6 style="font-size: 0.85rem;">{{env.selectedFirstClass}}</h6>
         <h6 class="h5-header">
           {{getDescriptionByIdInAList(selectedFirstClassId, firstClassList)}}
         </h6>
      </div>
      <div class="col-md-3 justify-content-center">
         <h6 *ngIf="selectedSecondClassId != env.placeholderSecondClass" style="font-size: 0.85rem;">{{env.selectedSecondClass}}</h6>
         <h6 class="h5-header">{{getDescriptionByIdInAList(selectedSecondClassId,secondClassList)}}</h6>
       </div>
       <div class="col-md-3 justify-content-center">
          <h6 *ngIf="selectedThirdClassId != env.placeholderThirdClass" style="font-size: 0.85rem;">{{env.selectedThirdClass}}</h6>
          <h6 class="h5-header">{{getDescriptionByIdInAList(selectedThirdClassId, thirdClassList)}}</h6>
       </div>
    </div>
  </div><br><br>
  <div class="container">
    <div class="row">
      <div class="col-md-3">
      <h4>Top 10</h4>
        <table class="table table-hover">
           <thead class="table-header">
             <tr>
               <th scope="col">Estado</th>
               <th scope="col">Número</th>
             </tr>
           </thead>
           <tbody class="table-body">
             <ng-container *ngIf="updatedResolution == env.placeholderStateResolution; else municipal">
               <tr *ngFor="let state of top10States">
                 <td>{{getStateName(state[0])}}</td>
                 <td>{{state[1]}}</td>
               </tr>
             </ng-container>
             <ng-template #municipal>
               <tr *ngFor="let mun of top10Municipalities">
                 <td>{{getStateName(mun[0])}} - {{getMunicipalityName(mun[1])}}</td>
                 <td>{{mun[2]}}</td>
               </tr>
             </ng-template>
           </tbody>
         </table>
      </div>
      <div class="col-md-3 offset-md-1">
         <h4>Totales</h4>
         <div class="table-container">
           <br>
           <h6>{{env.ageTotals}}</h6>
           <table class="table table-hover">
             <tbody class="table-body">
               <tr *ngFor="let total of showAgeTotals">
                 <td>{{total[0]}}</td>
                 <td>{{total[1]}}</td>
               </tr>
             </tbody>
           </table>
         </div>
      </div>
      <div class="col-md-3 offset-md-1">
         <div class="table-container">
           <br>
           <br>
           <h6>{{env.genderTotals}}</h6>
           <table class="table table-hover">
             <tbody class="table-body">
               <tr *ngFor="let total of showGenderTotals">
                 <td>{{total[0]}}</td>
                 <td>{{total[1]}}</td>
               </tr>
             </tbody>
           </table>

         </div>
      </div>
    </div>
  </div>
</body>

<!-- Modals -->

<button #showStateModal [hidden]="true"  type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#stateModal">
  Launch demo modal
</button>
<button #showMunModal [hidden]="true"  type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#municipality">
  Launch demo modal2
</button>
<button #showMetroModal [hidden]="true" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#metropoli">
  Launch demo modal2
</button>
<button #showPeriodModal [hidden]="true" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#periodModal">
  Launch demo modal
</button>


<!--- Modals --->
<div class="modal fade" id="stateModal" tabindex="-1" aria-labelledby="exampleModalLabel" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Estado</h5>
        <button type="button" class="btn-close" (click)="closingModal()" data-bs-dismiss="modal"
          aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <label for="exampleDataList">Seleccione el estado: </label>
        <input class="form-control" list="datalistOptions" id="exampleDataList" [(ngModel)]="selectedState"
          placeholder="Escriba para buscar...">
        <datalist id="datalistOptions">
          <ng-container *ngFor="let state of statesNameList">
            <option>{{ state }}</option>
          </ng-container>
        </datalist>
      </div>
      <div class="modal-footer">
        <button type="button" [hidden]="true" class="btn btn-secondary" #modalState
          data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" (click)="selectStateInModal()">Seleccionar</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="municipality" tabindex="-1" aria-labelledby="exampleModalLabel" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Municipio</h5>
        <button type="button" class="btn-close" (click)="closingModal()" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <label for="exampleDataList">Seleccione el estado: </label>
        <input class="form-control" list="datalistOptions" id="exampleDataList" [(ngModel)]="selectedState" (change)="onStateModalInputChange($event)"
          placeholder="Escriba para buscar...">
        <datalist id="datalistOptions">
          <ng-container *ngFor="let state of statesNameList">
            <option>{{ state }}</option>
          </ng-container>
        </datalist><br>
        <label for="exampleDataList">Seleccione el municipio: </label>
        <input class="form-control" list="datalistOptions2" id="exampleDataList" [(ngModel)]="selectedMuncipality"
          placeholder="Escriba para buscar..." >
        <datalist id="datalistOptions2">
          <ng-container *ngFor="let item of munNameList">
            <option value="{{item[3]}}">
          </ng-container>
        </datalist>
      </div>
      <div class="modal-footer">
        <button type="button" [hidden]="true" class="btn btn-secondary" #modalMun data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" (click)="verifyDataInMunModal()">Seleccionar</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="metropoli" tabindex="-1" aria-labelledby="exampleModalLabel" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Metropoli</h5>
        <button type="button" class="btn-close" (click)="closingModal()" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <label for="exampleDataList">Seleccione una metropoli: </label><br>
        <!-- <input class="form-control" list="datalistOptions2" id="exampleDataList" [(ngModel)]="selectedMuncipality" -->
        <select (change)="updateMetropoly($event)" >
            <option value="{{env.selectedMetropoli}}" selected>{{env.selectedMetropoli}}</option>
          <ng-container *ngFor="let item of metropolyList">
            <option value="{{item[0]}}">{{item[1]}}</option>
          </ng-container>
        </select>
      </div>
      <div class="modal-footer">
        <button type="button" [hidden]="true" class="btn btn-secondary" #closeMetroModal data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" (click)="verifyDataInMetroModal()">Seleccionar</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="periodModal" tabindex="-1" aria-labelledby="periodModalLabel" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="periodModalLabel">Seleccionar periodo</h5>
        <button type="button" class="btn-close" (click)="closingPeriodModal()" data-bs-dismiss="modal"
          aria-label="Close"></button>
      </div>

      <!-- Selection Modes (Tabs) -->
      <div class="modal-body p-0">
        <div class="p-3 border-bottom">
          <ul class="nav nav-pills nav-fill flex-nowrap" id="periodModeTabs">
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="search-tab" data-bs-toggle="pill" data-bs-target="#search-mode" type="button" role="tab" aria-controls="search-mode" aria-selected="true">
                Mes
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="list-tab" data-bs-toggle="pill" data-bs-target="#list-mode" type="button" role="tab" aria-controls="list-mode" aria-selected="false">
                Estación
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="year-tab" data-bs-toggle="pill" data-bs-target="#year-mode" type="button" role="tab" aria-controls="year-mode" aria-selected="false">
                Año
              </button>
            </li>
          </ul>
        </div>

        <!-- Content Area for Modes -->
        <div class="tab-content p-4" style="min-height: 300px; max-height: 400px; overflow-y: auto;">

          <!-- Search Mode -->
          <div class="tab-pane fade" id="search-mode" role="tabpanel" aria-labelledby="search-tab">
            <label for="stateSearchInput" class="form-label">Escriba para buscar:</label>
            <!-- <input class="form-control" list="datalistOptions" id="stateSearchInput" [(ngModel)]="selectedState" placeholder="Escriba el nombre del estado..."> -->
            <datalist id="datalistOptions">
              <ng-container *ngFor="let state of statesNameList">
                <option>{{ state }}</option>
              </ng-container>
            </datalist>
          </div>

          <!-- List Mode -->
          <div class="tab-pane fade" id="list-mode" role="tabpanel" aria-labelledby="list-tab">
            <div class="list-group">
              <ng-container *ngFor="let state of statesNameList">
                <!-- <button type="button" class="list-group-item list-group-item-action" [class.active]="selectedState === state" (click)="selectedState = state"> --> -->
                <!--   {{ state }} -->
                <!-- </button> -->
              </ng-container>
            </div>
          </div>

          <!-- Region Mode -->

          <div class="tab-pane show active fade" id="year-mode" role="tabpanel" aria-labelledby="year-tab">
            <h6 class="text-center mb-4">Seleccionar Año</h6>
            <div class="row row-cols-4 g-3">
              <ng-container *ngFor="let year of yearsList">
                <div class="col">
                  <button type="button" class="btn w-100 py-3" [class.btn-primary]="selectedYear === year" [class.btn-outline-secondary]="selectedYear !== year" (click)="selectedYear = year">
                    {{ year }}
                  </button>
                </div>
              </ng-container>
            </div>
          </div>

        </div>
      </div>

      <!-- Footer Buttons -->
      <div class="modal-footer">
        <button type="button" [hidden]="true" class="btn btn-secondary" #closePeriodModal data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" (click)="verifyPeriodSelectedcModal()">Seleccionar</button>
      </div>
    </div>
  </div>
</div>

